-= CVE-2003-0681 =-

Vulnerable versions: Sendmail 8.6.12 to ?
File: libsm/mbdb.c
Download from: source not available anymore

Domain: Server

_ Vulnerable Functions and Buffers _

Function buildfname (originally sm_pwfullname) takes a gecos and a
login string as arguments and, for each occurence of the '&' character
in the gecos string, blindly appends (strcpy) the login string to a
fixed size buffer. The patched version (1) uses strncpy with a safe
bound instead of strcpy, and (2) calculates the length of the final
string before entering the outer loop.

Note that (2) requires counting the number of times a branch can be
taken, and is difficult for most analyses.

_ Decomposed Programs _

buildfname/inner_{ok,bad}.c
buildfname/outer_{ok,bad}.c
buildfname/both_{ok,bad}.c

The inner testcases contain the inner loop --- a str(n)cpy.

The outer testcases contain the outer loop; the OK testcases are
protected by a call to strlen.

The both testcases contain both loops, protected by a calculation of
the length of the entire string, which can involve multiple calls to
strlen.

_ Notes _

This is Zitser's sendmail/s2, simplified.

BASE_SZ was originally 256.
